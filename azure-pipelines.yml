---
trigger:
  - none

parameters:
  - name: environment
    displayName: Environment
    type: string
    default: 'sbox,test'
    values:
      - sbox
      - test

variables:
  - group: HMI-APIM-Common
  - ${{ if eq(parameters.environment, 'sbox') }}:
    - group: HMI-APIM-BUILD-SBOX
  - ${{ if eq(parameters.environment, 'test') }}:
    - group: HMI-APIM-BUILD-TEST

stages:

  - stage: BUILD
    displayName: Build infrastructure with Terraform

    jobs:
    - ${{ if contains(parameters.environment, 'sbox') }}:
      - job: sbox
        steps:
        - script: echo Building sbox... $(subscription)
    - ${{ if contains(parameters.environment, 'test') }}:
      - job: test
        steps:
        - script: echo Building test... $(subscription)
