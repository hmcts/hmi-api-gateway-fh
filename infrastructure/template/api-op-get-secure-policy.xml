<policies>
	<inbound>
		<validate-jwt header-name="Authorization" failed-validation-httpcode="401"
			failed-validation-error-message="Access denied due to invalid OAuth information">
			<openid-config
				url="https://sts.windows.net/531ff96d-0ae9-462a-8d2d-bec7c0b42082/.well-known/openid-configuration" />
			<audiences>
				<audience>api://d49d7fa2-6904-4223-a907-3b8992af4190</audience>
			</audiences>
			<required-claims>
				<claim name="roles" match="all">
					<value>hmiGateway</value>
				</claim>
			</required-claims>
		</validate-jwt>
		<choose>
			<when condition="@(context.Request.Headers.GetValueOrDefault("Destination-System","") == "CFT")">
				<rewrite-uri template="/create-hearing" copy-unmatched-params="true" />
				<set-backend-service base-url="http://#{hostName}#/hearings/" />
			</when>
		</choose>
	</inbound>
	<backend>
		<base />
	</backend>
	<outbound>
		<base />
	</outbound>
	<on-error>
		<base />
	</on-error>
</policies>