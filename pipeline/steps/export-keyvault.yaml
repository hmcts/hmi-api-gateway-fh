parameters:
  - name: subscription
    type: string
    default: ''

  - name: keyVaultName
    type: string
    default: ''

steps:
- task: AzureKeyVault@1
  displayName: 'Export Secrets from KeyVault'
  inputs:
    azureSubscription: ${{ parameters.subscription }}
    keyVaultName: ${{ parameters.keyVaultName }}
    secretsFilter: 'hmi-apim-sub-key'
- script: |
    echo "##vso[task.setvariable variable=hmi-apim-sub-key;isOutput=true;isSecret=true]$(hmi-apim-sub-key)"
  displayName: 'Export KeyVault Variables'
  name: exportKeyVaultSecret