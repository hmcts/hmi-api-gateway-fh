parameters:
  - name: registry
    type: string

  - name: repository
    type: string
  
  - name: tags
    type: string

  - name: volumes
    type: string

  - name: testUrl
    type: string
    
  - name: securityRules
    type: string

steps:
- task: Docker@1
  displayName: Run an image
  inputs:
    containerregistrytype: Container Registry
    dockerRegistryEndpoint: ${{ parameters.registry }}
    command: Run an image
    imageName: ssprivatesbox.azurecr.io/hmi/apim-tests-owasp:${{ parameters.tags }}
    volumes: ${{ parameters.volumes }}
    envVars: |
     TEST_URL=${{ parameters.testUrl }}
     SecurityRules=${{ parameters.securityRules }}
    workingDirectory: $(System.DefaultWorkingDirectory)
    containerCommand: /bin/bash ./security.sh
    runInBackground: false