parameters:
  - name: registry
    type: string

  - name: repository
    type: string
  
  - name: tags
    type: string

  - name: volumes
    type: string

  - name: testUrl
    type: string
    
  - name: securityRules
    type: string

steps:
- task: Docker@1
  displayName: 'Run an image'
  inputs:
    containerregistrytype: 'Container Registry'
    dockerRegistryEndpoint: ${{ parameters.registry }}
    command: 'Run an image'
    imageName: 'ssprivatesbox.azurecr.io/hmi/apim-tests-owasp:latest'
    volumes: '$(System.DefaultWorkingDirectory)/zap:/zap/wrk/:rw'
    envVars: |
     TEST_URL=https://www.example.com/openapi.json 
     SecurityRules=https://raw.githubusercontent.com/hmcts/security-test-rules/master/conf/security-rules.conf
    workingDirectory: '$(System.DefaultWorkingDirectory)'
    containerCommand: '/bin/bash ./security.sh'
    runInBackground: false